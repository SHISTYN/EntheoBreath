import{j as e,A as O,m as M}from"./vendor-motion-BZnxEU2V.js";import{R as S,r as c}from"./vendor-react-OXzYy3Vh.js";import{aV as $,aW as E,aX as D,aY as F,aZ as A,a_ as T,a$ as R,ae as H,b0 as _,C as U}from"./vendor-icons-CZBwbNoe.js";const I=M.div,P=(s,r=200)=>{const[d,n]=c.useState(!1),x=c.useRef(null),o=c.useRef(null),i=c.useRef(r),h=c.useCallback(()=>{s(),i.current=400,x.current=setTimeout(()=>{n(!0),o.current=setInterval(()=>{s(),i.current>50&&(i.current=Math.max(50,i.current-50),o.current&&clearInterval(o.current),o.current=setInterval(s,i.current))},i.current)},500)},[s]),m=c.useCallback(()=>{x.current&&clearTimeout(x.current),o.current&&clearInterval(o.current),n(!1),i.current=r},[r]);return{onMouseDown:h,onMouseUp:m,onMouseLeave:m,onTouchStart:h,onTouchEnd:m}},u=({label:s,value:r,step:d=1,onChange:n,color:x,subLabel:o})=>{const i=()=>n(Number((r+d).toFixed(1))),h=()=>n(Math.max(0,Number((r-d).toFixed(1)))),m=P(i),l=P(h),b=r>=100?"text-3xl":"text-4xl";return e.jsxs("div",{className:"flex flex-col w-full gap-2 group",children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-zinc-500 transition-colors group-hover:text-zinc-300",children:s})}),e.jsxs("div",{className:"relative flex items-stretch w-full h-16 md:h-20 rounded-2xl md:rounded-3xl overflow-hidden shadow-lg transition-all duration-300 bg-white/40 dark:bg-[#0a0a0b]/60 backdrop-blur-2xl group-hover:shadow-[0_0_30px_-10px_rgba(34,211,238,0.15)] border border-black/5 dark:border-white/10 ring-1 ring-black/5 dark:ring-white/5",children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-500 z-0 pointer-events-none",style:{background:`radial-gradient(circle at center, ${x}, transparent 70%)`}}),e.jsx("button",{...l,className:"relative z-10 w-12 md:w-14 flex items-center justify-center bg-transparent hover:bg-white/5 active:bg-white/10 transition-colors border-r border-white/5",children:e.jsx(R,{size:16,className:"text-zinc-400 group-hover:text-white transition-colors"})}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center overflow-hidden",children:[e.jsx("div",{className:"flex items-baseline gap-1 relative z-20 w-full px-2",children:e.jsx("input",{type:"number",inputMode:"decimal",value:r===0?"":r.toString(),placeholder:"0",onChange:f=>{const p=parseFloat(f.target.value);isNaN(p)?f.target.value===""&&n(0):n(p)},className:`
                                bg-transparent text-center w-full focus:outline-none 
                                font-mono font-bold ${b} tracking-tighter tabular-nums leading-none text-white 
                                drop-shadow-md transition-all appearance-none m-0 p-0
                                placeholder-white/20
                                [&::-webkit-inner-spin-button]:appearance-none
                            `,style:{textShadow:r>0?`0 0 15px ${x}60`:"none"}})}),o&&e.jsx("span",{className:"absolute bottom-1.5 text-[8px] font-bold text-zinc-500 uppercase pointer-events-none",children:o})]}),e.jsx("button",{...m,className:"relative z-10 w-12 md:w-14 flex items-center justify-center bg-transparent hover:bg-white/5 active:bg-white/10 transition-colors border-l border-white/5",children:e.jsx(_,{size:16,className:"text-zinc-400 group-hover:text-white transition-colors"})})]})]})},V=({pattern:s,onChange:r,rounds:d,onRoundsChange:n,readOnly:x=!1})=>{var j,N,k,y,z,C;const[o,i]=c.useState(!1),h=c.useRef(null),l=s.presets?s.presets.findIndex(t=>t.inhale===s.inhale&&t.holdIn===s.holdIn&&t.exhale===s.exhale&&t.holdOut===s.holdOut&&(s.mode==="wim-hof"?t.breathCount===s.breathCount:!0)):-1,b=l===-1&&(((j=s.presets)==null?void 0:j.length)||0)>0;c.useEffect(()=>{if(o&&h.current&&l!==-1){const t=h.current.children[l];t&&t.scrollIntoView({block:"center",behavior:"auto"})}},[o,l]);const f=t=>{if(!s.presets||!s.presets[t])return;const a=s.presets[t];r({...s,inhale:a.inhale,holdIn:a.holdIn,exhale:a.exhale,holdOut:a.holdOut,breathCount:a.breathCount??s.breathCount,retentionProfile:a.retentionProfile??s.retentionProfile}),i(!1)};if(x)return null;const p=s.holdIn>0||s.mode==="manual"||s.mode==="wim-hof",v=s.holdOut>0||s.mode==="manual",L=()=>{if(s.mode==="wim-hof")return"grid-cols-1 sm:grid-cols-3";let t=2;return p&&t++,v&&t++,t===4?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4":t===3?"grid-cols-1 sm:grid-cols-3":"grid-cols-1 sm:grid-cols-2"};return e.jsxs("div",{className:"w-full animate-fade-in flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-stretch gap-4 w-full relative z-50",children:[s.presets&&s.presets.length>0&&e.jsxs("div",{className:"relative flex-grow min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-[44px_1fr_44px] items-center bg-white/40 dark:bg-[#0a0a0b]/80 backdrop-blur-xl border border-black/5 dark:border-white/10 rounded-2xl h-14 hover:border-black/10 dark:hover:border-white/20 transition-colors shadow-lg ring-1 ring-black/5 dark:ring-white/5",children:[e.jsx("button",{onClick:()=>s.presets&&f(l>0?l-1:0),disabled:l<=0&&!b,className:"h-full flex items-center justify-center text-zinc-500 hover:text-white disabled:opacity-20 border-r border-white/5 active:bg-white/5",children:e.jsx($,{size:20})}),e.jsxs("button",{onClick:()=>i(!0),className:"h-full flex flex-col items-center justify-center px-2 cursor-pointer w-full group overflow-hidden relative active:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 max-w-full",children:[e.jsx(E,{size:14,className:"text-zinc-500 shrink-0"}),e.jsx("span",{className:"text-[11px] font-bold text-zinc-300 group-hover:text-white uppercase tracking-widest truncate",children:b?"Свой режим":(N=s.presets[l])==null?void 0:N.name.split(" • ")[0]}),e.jsx(D,{size:12,className:"text-zinc-500 shrink-0"})]}),!b&&((k=s.presets[l])==null?void 0:k.name.includes(" • "))&&e.jsx("span",{className:"text-[9px] text-cyan-500/70 font-bold uppercase tracking-wider absolute bottom-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:(y=s.presets[l])==null?void 0:y.name.split(" • ")[1]})]}),e.jsx("button",{onClick:()=>s.presets&&f(l<s.presets.length-1?l+1:0),disabled:l>=(((z=s.presets)==null?void 0:z.length)||0)-1,className:"h-full flex items-center justify-center text-zinc-500 hover:text-white disabled:opacity-20 border-l border-white/5 active:bg-white/5",children:e.jsx(F,{size:20})})]}),e.jsx(O,{children:o&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx(I,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>i(!1),className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs(I,{initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},className:"w-full max-w-sm bg-[#121212] border border-white/10 rounded-3xl shadow-2xl relative z-10 max-h-[60vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs font-bold uppercase text-zinc-400 tracking-widest flex items-center gap-2",children:[e.jsx(A,{size:14})," Выберите уровень"]}),e.jsx("button",{onClick:()=>i(!1),className:"p-1 hover:bg-white/10 rounded-full text-zinc-500 hover:text-white transition-colors",children:e.jsx(T,{size:18})})]}),e.jsx("div",{ref:h,className:"overflow-y-auto custom-scrollbar flex-1 p-2",children:(C=s.presets)==null?void 0:C.map((t,a)=>{const w=a===l,g=t.name.split(" • ");return e.jsxs("button",{onClick:()=>f(a),className:`w-full text-left px-4 py-3 rounded-2xl mb-1 flex items-center justify-between transition-all group ${w?"bg-white/10 text-cyan-400 border border-white/5":"hover:bg-white/5 text-zinc-400 border border-transparent"}`,children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:`text-[11px] font-bold uppercase tracking-wide truncate ${w?"text-cyan-400":"text-zinc-300"}`,children:g[0]}),g[1]&&e.jsx("span",{className:`text-[9px] font-medium mt-0.5 ${w?"text-cyan-500/60":"text-zinc-600"}`,children:g[1]})]}),w&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-500 shadow-[0_0_8px_cyan] shrink-0 ml-2"})]},a)})})]})]})})]}),s.mode!=="stopwatch"&&s.mode!=="wim-hof"&&e.jsxs("div",{className:"flex items-center gap-1 bg-white/40 dark:bg-[#0a0a0b]/80 backdrop-blur-xl border border-black/5 dark:border-white/10 rounded-2xl px-1 h-14 hover:border-black/10 dark:hover:border-white/20 transition-colors shrink-0 shadow-lg ring-1 ring-black/5 dark:ring-white/5",children:[e.jsx("button",{onClick:()=>n(Math.max(0,d-1)),className:"w-10 h-full flex items-center justify-center text-zinc-500 hover:text-white transition-colors active:scale-90",children:e.jsx(R,{size:18})}),e.jsxs("div",{className:"flex flex-col items-center w-10 justify-center min-h-[20px]",children:[d===0?e.jsx(H,{size:16,className:"text-white rotate-90"}):e.jsx("span",{className:"font-mono font-bold text-lg text-white leading-none",children:d}),e.jsx("span",{className:"text-[7px] font-bold uppercase text-zinc-600 mt-0.5",children:"Круги"})]}),e.jsx("button",{onClick:()=>n(d+1),className:"w-10 h-full flex items-center justify-center text-zinc-500 hover:text-white transition-colors active:scale-90",children:e.jsx(_,{size:18})})]})]}),e.jsx("div",{className:"w-full relative z-10",children:s.mode==="stopwatch"?e.jsxs("div",{className:"text-center flex flex-col items-center gap-3 py-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-zinc-900 border border-white/10 flex items-center justify-center text-zinc-500 shadow-inner",children:e.jsx(U,{size:24})}),e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-500",children:"Свободный режим"})]}):e.jsx("div",{className:`grid gap-4 ${L()}`,children:s.mode==="wim-hof"?e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Вдохи",value:s.breathCount||30,step:5,color:"#22d3ee",onChange:t=>r({...s,breathCount:t})}),e.jsx(u,{label:"Темп",subLabel:"с",value:s.inhale,step:.1,color:"#94a3b8",onChange:t=>r({...s,inhale:t,exhale:t*.6})}),e.jsx(u,{label:"Восстан.",subLabel:"с",value:s.holdIn,step:1,color:"#7C3AED",onChange:t=>r({...s,holdIn:t})})]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Вдох",value:s.inhale,step:1,color:"#22d3ee",onChange:t=>r({...s,inhale:t})}),p&&e.jsx(u,{label:"Задержка",value:s.holdIn,step:1,color:"#F59E0B",onChange:t=>r({...s,holdIn:t})}),e.jsx(u,{label:"Выдох",value:s.exhale,step:1,color:"#7C3AED",onChange:t=>r({...s,exhale:t})}),v&&e.jsx(u,{label:"Пауза",value:s.holdOut,step:1,color:"#fb7185",onChange:t=>r({...s,holdOut:t})})]})})})]})},W=S.memo(V);export{W as default};
