import{j as e,m as O}from"./vendor-motion-BZnxEU2V.js";import{r as s}from"./vendor-react-OXzYy3Vh.js";const U=O.path,H=O.span,W=O.div,f={slow:{label:"Медленно",inhale:2.5,exhale:2,total:4.5},normal:{label:"Обычно",inhale:1.8,exhale:1.4,total:3.2},fast:{label:"Быстро",inhale:1.2,exhale:1.2,total:2.4}},G=({state:p,speed:b,label:T,subLabel:N,scale:t=1,color:r="#48CFE1",showLayers:c=!0})=>{const w="M100 20 L170 60 L170 140 L100 180 L30 140 L30 60 Z",u={duration:b.inhale,ease:[.42,0,.58,1]},g={duration:b.exhale,ease:[.42,0,.58,1]},l={inhale:n=>({scale:1+n*.18,opacity:.7-n*.15,transition:{...u,delay:n*.06}}),exhale:n=>({scale:.7+n*.04,opacity:.1+n*.1,transition:{...g,delay:n*.04}}),hold:{scale:1,opacity:.5,transition:{duration:.5}},static:{scale:1,opacity:.3}},v={inhale:{scale:1.4,opacity:1,filter:"blur(0px)",textShadow:`0 0 30px ${r}80`,transition:u},exhale:{scale:.8,opacity:.5,filter:"blur(1px)",textShadow:`0 0 0px ${r}00`,transition:g},hold:{scale:1,opacity:1,filter:"blur(0px)",textShadow:"none"},static:{scale:1,opacity:1,filter:"blur(0px)",textShadow:"none"}};return e.jsxs("div",{className:"relative flex items-center justify-center w-[260px] h-[260px] md:w-[320px] md:h-[320px]",style:{transform:`scale(${t})`},children:[e.jsxs("svg",{viewBox:"0 0 200 200",className:"absolute inset-0 w-full h-full overflow-visible",children:[e.jsx("defs",{children:e.jsxs("filter",{id:"glowHex",children:[e.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),c&&[2,1,0].map(n=>e.jsx(U,{custom:n,d:w,fill:n===0?`${r}15`:"none",stroke:r,strokeWidth:n===0?3:2,variants:l,animate:p,style:{originX:.5,originY:.5,filter:n===0?"url(#glowHex)":"none",opacity:1}},n))]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center pointer-events-none",children:[e.jsx(H,{variants:v,animate:p,className:"font-display font-bold text-zinc-900 dark:text-white tabular-nums leading-none text-6xl md:text-8xl bg-gradient-to-b from-zinc-800 to-zinc-500 dark:from-white dark:via-white dark:to-gray-400 bg-[length:100%_200%] animate-shimmer-slow bg-clip-text text-transparent",children:T}),N&&e.jsx(H,{animate:{opacity:p==="inhale"||p==="hold"?1:.6},className:"mt-4 text-[10px] font-bold uppercase tracking-[0.3em] text-zinc-600 dark:text-white/80 bg-white/80 dark:bg-black/30 px-4 py-1.5 rounded-full border border-zinc-200 dark:border-white/10 shadow-sm whitespace-nowrap",children:N})]})]})},q=({pattern:p,onExit:b,isZenMode:T,onToggleZen:N})=>{const[t,r]=s.useState("SETUP"),[c,w]=s.useState(3),[u,g]=s.useState(30),[l,v]=s.useState("normal"),[n,I]=s.useState(1),[D,S]=s.useState(1),[P,d]=s.useState(0),m=s.useRef(null),E=s.useRef(0),[V,A]=s.useState("inhale"),[F,Y]=s.useState(1);s.useEffect(()=>{if(t!=="SETUP")return;let a,o;const i=f[l],x=()=>{A("inhale"),a=setTimeout(()=>{A("exhale"),o=setTimeout(()=>{Y(h=>h>=9?1:h+1),x()},i.exhale*1e3)},i.inhale*1e3)};return x(),()=>{clearTimeout(a),clearTimeout(o)}},[l,t]);const y=s.useCallback(()=>{r("RETENTION"),d(0),k("static")},[]),[R,k]=s.useState("static");s.useEffect(()=>{if(t!=="BREATHING")return;let a=!0;const o=f[l],i=h=>new Promise(j=>{setTimeout(j,h)}),x=async()=>{k("inhale"),await i(o.inhale*1e3),!(!a||t!=="BREATHING")&&(k("exhale"),await i(o.exhale*1e3),!(!a||t!=="BREATHING")&&(S(h=>{const j=h+1;return j>u?(y(),h):j}),t==="BREATHING"&&x()))};return x(),()=>{a=!1}},[t,l,u,y]);const B=s.useCallback(()=>{t==="PREP"?(r("BREATHING"),S(1)):t==="RECOVERY_PREP"?(r("RECOVERY"),d(15)):t==="RECOVERY"?(r("ROUND_WAIT"),d(3)):t==="ROUND_WAIT"&&(c<=10&&n>=c?r("DONE"):(I(a=>a+1),r("PREP"),d(3)))},[t,c,n]),C=s.useCallback(a=>{E.current||(E.current=a);const o=(a-E.current)/1e3;E.current=a,t==="RETENTION"?d(i=>i+o):["PREP","RECOVERY_PREP","RECOVERY","ROUND_WAIT"].includes(t)&&d(i=>{const x=i-o;return x<=0?(B(),0):x}),m.current=requestAnimationFrame(C)},[t,B]);s.useEffect(()=>{if(t==="SETUP"||t==="BREATHING"||t==="DONE"){m.current&&cancelAnimationFrame(m.current),E.current=0;return}return m.current=requestAnimationFrame(C),()=>{m.current&&cancelAnimationFrame(m.current)}},[t,C]);const M=()=>{N&&!T&&N(),r("PREP"),I(1),d(3)},z=()=>{t==="BREATHING"?y():t==="RETENTION"&&(r("RECOVERY_PREP"),d(3))},_=a=>{const o=Math.floor(a/60),i=Math.floor(a%60);return`${o.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`};return e.jsx("div",{className:"w-full flex flex-col relative font-sans",children:t==="SETUP"?e.jsxs("div",{className:"w-full flex flex-col items-center justify-start pt-4 md:pt-0",children:[e.jsxs("div",{className:"w-full flex flex-col items-center justify-center animate-fade-in py-4 relative shrink-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-zinc-400 dark:text-gray-500 uppercase tracking-widest mb-4 opacity-60",children:"Предпросмотр темпа"}),e.jsx(G,{state:V,speed:f[l],label:F,scale:1,color:"#48CFE1"}),e.jsx("div",{className:"flex gap-2 mt-6 bg-zinc-100 dark:bg-white/5 p-1 rounded-xl border border-zinc-200 dark:border-white/5 relative z-20",children:["slow","normal","fast"].map(a=>e.jsx("button",{onClick:()=>v(a),className:`px-4 py-2 rounded-lg text-[10px] font-bold uppercase tracking-wide transition-all ${l===a?"bg-[#48CFE1] text-black shadow-glow-cyan":"text-zinc-500 dark:text-gray-400 hover:text-black dark:hover:text-white hover:bg-white/5"}`,children:f[a].label},a))})]}),e.jsxs("div",{className:"w-full max-w-md bg-white/50 dark:bg-[#050505]/50 backdrop-blur-md border border-zinc-200 dark:border-white/5 p-6 rounded-2xl mb-[calc(1rem+env(safe-area-inset-bottom))] relative group shrink-0",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-zinc-200 dark:border-white/5",children:e.jsxs("span",{className:"text-xs font-bold uppercase text-zinc-400 tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sliders-h"})," Настройки"]})}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 md:gap-6 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-zinc-100 dark:bg-white/5 rounded-xl p-1.5 border border-zinc-200 dark:border-white/5 shrink-0",children:[e.jsx("button",{onClick:()=>w(a=>Math.max(1,a-1)),className:"w-10 h-10 rounded-lg flex items-center justify-center hover:bg-white/10 text-gray-400 transition-colors",children:e.jsx("i",{className:"fas fa-minus text-xs"})}),e.jsx("span",{className:"font-display font-bold text-zinc-900 dark:text-white text-lg w-6 text-center",children:c>10?"∞":c}),e.jsx("button",{onClick:()=>w(a=>a<=10?a+1:11),className:"w-10 h-10 rounded-lg flex items-center justify-center hover:bg-white/10 text-gray-400 transition-colors",children:e.jsx("i",{className:"fas fa-plus text-xs"})})]}),e.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider hidden xs:inline",children:"Раунды"}),e.jsx("div",{className:"hidden xs:block flex-1"}),e.jsxs("div",{className:"flex flex-col items-end gap-1 ml-auto",children:[e.jsxs("span",{className:"text-[10px] font-bold text-gray-500 uppercase",children:["Вдохи: ",e.jsx("span",{className:"text-[#48CFE1] text-base",children:u})]}),e.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:u,onChange:a=>g(Number(a.target.value)),className:"w-24 h-1.5 bg-zinc-200 dark:bg-white/10 rounded-lg appearance-none cursor-pointer accent-[#48CFE1]"})]})]}),e.jsx("button",{onClick:M,className:"w-full py-4 bg-gradient-to-r from-[#48CFE1] to-cyan-600 text-black dark:text-[#0B0E11] font-display font-bold text-lg uppercase tracking-widest rounded-xl shadow-glow-cyan hover:scale-[1.01] active:scale-95 transition-all",children:"Начать Практику"})]})]})]}):e.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#050505] flex flex-col items-center justify-center p-4",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 pt-[calc(env(safe-area-inset-top)+20px)] w-full flex justify-between px-6 z-20",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Раунд"}),e.jsxs("span",{className:"text-2xl font-display font-bold text-white leading-none",children:[n,"/",c]})]}),e.jsx("button",{onClick:b,className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-white/20 transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("h2",{className:"absolute top-[20%] w-full text-center text-xl md:text-3xl font-display font-bold text-white px-4 animate-fade-in z-20 tracking-wide",children:t==="RETENTION"?"ВЫДОХНИТЕ И ЗАДЕРЖИТЕ":t==="RECOVERY_PREP"?"ПРИГОТОВЬТЕСЬ...":t==="RECOVERY"?"ДЕРЖИТЕ ДЫХАНИЕ":t==="BREATHING"?"РИТМИЧНОЕ ДЫХАНИЕ":t==="ROUND_WAIT"?"ОТЛИЧНО!":t==="PREP"?"ПРИГОТОВЬТЕСЬ":""}),e.jsx(W,{className:"relative z-10",animate:t==="BREATHING"?{scale:R==="inhale"?1.1:.9}:{scale:1},transition:{duration:t==="BREATHING"?R==="inhale"?f[l].inhale:f[l].exhale:.5},children:e.jsx(G,{state:t==="BREATHING"?R:t==="RETENTION"?"static":t==="RECOVERY_PREP"?"inhale":t==="RECOVERY"?"hold":"static",speed:f[l],label:t==="BREATHING"?D:t==="RETENTION"?_(P):t==="DONE"?"✓":Math.ceil(P),subLabel:t==="BREATHING"?R==="inhale"?"ВДОХ":"ВЫДОХ":t==="RETENTION"?"ЗАДЕРЖКА":t==="RECOVERY"?"ДЕРЖИТЕ":t==="DONE"?"ФИНИШ":"",color:t==="RETENTION"?"#F59E0B":t==="RECOVERY"?"#A855F7":"#48CFE1",showLayers:!["RETENTION","ROUND_WAIT","DONE"].includes(t)})}),t==="BREATHING"&&e.jsx("div",{className:"absolute bottom-[calc(2.5rem+env(safe-area-inset-bottom))] px-6 py-2 rounded-full bg-white/5 border border-white/5 backdrop-blur-md animate-pulse",children:e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Двойной тап: стоп"})}),t==="RETENTION"&&e.jsx("div",{className:"absolute bottom-[calc(2.5rem+env(safe-area-inset-bottom))] px-6 py-2 rounded-full bg-amber-500/10 border border-amber-500/20 backdrop-blur-md animate-pulse",children:e.jsx("span",{className:"text-xs font-bold text-amber-500 uppercase tracking-widest",children:"Тапните для вдоха"})}),t==="DONE"&&e.jsx("div",{className:"absolute bottom-[calc(2.5rem+env(safe-area-inset-bottom))] w-full px-8 max-w-md",children:e.jsx("button",{onClick:b,className:"w-full py-4 bg-white text-black font-bold rounded-xl shadow-lg uppercase tracking-widest",children:"Завершить"})}),e.jsx("div",{className:"absolute inset-0 z-0",onDoubleClick:t==="BREATHING"||t==="RETENTION"?z:void 0,onClick:t==="RETENTION"?z:void 0})]})})};export{q as default};
